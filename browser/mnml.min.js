if(typeof module=="undefined")var mnml=this.mnml={};else var mnml=module.exports;mnml.parser=function(){var a={parse:function(a,b){function i(a,b,c){var d=a,e=c-a.length;for(var f=0;f<e;f++)d=b+d;return d}function j(a){var b=a.charCodeAt(0);if(b<=255)var c="x",d=2;else var c="u",d=4;return"\\"+c+i(b.toString(16).toUpperCase(),"0",d)}function k(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/[\x80-\uFFFF]/g,j)+'"'}function l(a){if(d<f)return;d>f&&(f=d,g=[]),g.push(a)}function m(){var a="nodelist@"+d,b=h[a];if(b)return d=b.nextPos,b.result;var c=d,e=d,f=[],g=A();while(g!==null){f.push(g);var g=A()}if(f!==null){var i=[],j=n();while(j!==null){i.push(j);var j=n()}if(i!==null){var k=[],l=A();while(l!==null){k.push(l);var l=A()}if(k!==null)var m=[f,i,k];else{var m=null;d=e}}else{var m=null;d=e}}else{var m=null;d=e}var o=m!==null?function(a){return a}(m[1]):null;if(o!==null)var p=o;else{var p=null;d=c}return h[a]={nextPos:d,result:p},p}function n(){var b="node@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d,g=d,i=o();if(i!==null){if(a.substr(d,2)==="->"){var j="->";d+=2}else{var j=null;e&&l('"->"')}if(j!==null){var k=v(),m=k!==null?k:"";if(m!==null){var n=y();if(n!==null){var q=A();if(q!==null){var r=x();if(r!==null){var s=z();if(s!==null){var t=A();if(t!==null)var u=[i,j,m,n,q,r,s,t];else{var u=null;d=g}}else{var u=null;d=g}}else{var u=null;d=g}}else{var u=null;d=g}}else{var u=null;d=g}}else{var u=null;d=g}}else{var u=null;d=g}}else{var u=null;d=g}var B=u!==null?function(a,b){return{name:a.name,args:a.args,text:b,children:[]}}(u[0],u[5]):null;if(B!==null)var C=B;else{var C=null;d=f}if(C!==null)var D=C;else{var E=d,F=d,G=o();if(G!==null){var H=w();if(H!==null){var I=p(),J=I!==null?I:"";if(J!==null)var K=[G,H,J];else{var K=null;d=F}}else{var K=null;d=F}}else{var K=null;d=F}var L=K!==null?function(a,b,c){return{name:a.name,args:a.args,text:b,children:c}}(K[0],K[1],K[2]):null;if(L!==null)var M=L;else{var M=null;d=E}if(M!==null)var D=M;else var D=null}return h[b]={nextPos:d,result:D},D}function o(){var a="nodehead@"+d,b=h[a];if(b)return d=b.nextPos,b.result;var c=e;e=!1;var f=d,g=d,i=u();if(i!==null){var j=q(),k=j!==null?j:"";if(k!==null){var m=v(),n=m!==null?m:"";if(n!==null)var o=[i,k,n];else{var o=null;d=g}}else{var o=null;d=g}}else{var o=null;d=g}var p=o!==null?function(a,b){var c={};return b&&b.map(function(a){c[a.key]=a.value}),{name:a,args:c}}(o[0],o[1]):null;if(p!==null)var r=p;else{var r=null;d=f}return e=c,e&&r===null&&l("node head"),h[a]={nextPos:d,result:r},r}function p(){var a="childblock@"+d,b=h[a];if(b)return d=b.nextPos,b.result;var c=d,e=d,f=y();if(f!==null){var g=m();if(g!==null){var i=z();if(i!==null){var j=A();if(j!==null)var k=[f,g,i,j];else{var k=null;d=e}}else{var k=null;d=e}}else{var k=null;d=e}}else{var k=null;d=e}var l=k!==null?function(a){return a}(k[1]):null;if(l!==null)var n=l;else{var n=null;d=c}return h[a]={nextPos:d,result:n},n}function q(){var a="arglist@"+d,b=h[a];if(b)return d=b.nextPos,b.result;var c=e;e=!1;var f=d,g=r();if(g!==null){var i=[];while(g!==null){i.push(g);var g=r()}}else var i=null;var j=i!==null?function(a){return a}(i):null;if(j!==null)var k=j;else{var k=null;d=f}return e=c,e&&k===null&&l("argument list"),h[a]={nextPos:d,result:k},k}function r(){var b="argument@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=e;e=!1;var g=d,i=d,j=v();if(j!==null){var k=u();if(k!==null){if(a.substr(d,1)==="="){var m="=";d+=1}else{var m=null;e&&l('"="')}if(m!==null){var n=s();if(n!==null)var o=[j,k,m,n];else{var o=null;d=i}}else{var o=null;d=i}}else{var o=null;d=i}}else{var o=null;d=i}var p=o!==null?function(a,b){return{key:a,value:b}}(o[1],o[3]):null;if(p!==null)var q=p;else{var q=null;d=g}return e=f,e&&q===null&&l("key/value pair"),h[b]={nextPos:d,result:q},q}function s(){var b="value@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=e;e=!1;var g=d,i=d;if(a.substr(d,1)==='"'){var j='"';d+=1}else{var j=null;e&&l('"\\""')}if(j!==null){var k=[],m=t();while(m!==null){k.push(m);var m=t()}if(k!==null){if(a.substr(d,1)==='"'){var n='"';d+=1}else{var n=null;e&&l('"\\""')}if(n!==null)var o=[j,k,n];else{var o=null;d=i}}else{var o=null;d=i}}else{var o=null;d=i}var p=o!==null?function(a){return a.join("")}(o[1]):null;if(p!==null)var q=p;else{var q=null;d=g}if(q!==null)var r=q;else{var s=d,u=[];if(a.substr(d).match(/^[a-zA-Z0-9_\-]/)!==null){var v=a.charAt(d);d++}else{var v=null;e&&l("[a-zA-Z0-9_\\-]")}while(v!==null){u.push(v);if(a.substr(d).match(/^[a-zA-Z0-9_\-]/)!==null){var v=a.charAt(d);d++}else{var v=null;e&&l("[a-zA-Z0-9_\\-]")}}var w=u!==null?function(a){return a.join("")}(u):null;if(w!==null)var x=w;else{var x=null;d=s}if(x!==null)var r=x;else var r=null}return e=f,e&&r===null&&l("value"),h[b]={nextPos:d,result:r},r}function t(){var b="quotedchar@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=d;if(a.substr(d,2)==='\\"'){var g='\\"';d+=2}else{var g=null;e&&l('"\\\\\\""')}var i=g!==null?function(){return'"'}():null;if(i!==null)var j=i;else{var j=null;d=f}if(j!==null)var k=j;else{if(a.substr(d).match(/^[^"]/)!==null){var m=a.charAt(d);d++}else{var m=null;e&&l('[^"]')}if(m!==null)var k=m;else var k=null}return h[b]={nextPos:d,result:k},k}function u(){var b="identifier@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=e;e=!1;var g=d,i=d;if(a.substr(d).match(/^[a-zA-Z_]/)!==null){var j=a.charAt(d);d++}else{var j=null;e&&l("[a-zA-Z_]")}if(j!==null){var k=[];if(a.substr(d).match(/^[a-zA-Z0-9_]/)!==null){var m=a.charAt(d);d++}else{var m=null;e&&l("[a-zA-Z0-9_]")}while(m!==null){k.push(m);if(a.substr(d).match(/^[a-zA-Z0-9_]/)!==null){var m=a.charAt(d);d++}else{var m=null;e&&l("[a-zA-Z0-9_]")}}if(k!==null)var n=[j,k];else{var n=null;d=i}}else{var n=null;d=i}var o=n!==null?function(a,b){return a+b.join("")}(n[0],n[1]):null;if(o!==null)var p=o;else{var p=null;d=g}return e=f,e&&p===null&&l("identifier"),h[b]={nextPos:d,result:p},p}function v(){var b="whitespace@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=e;e=!1;if(a.substr(d).match(/^[ 	]/)!==null){var g=a.charAt(d);d++}else{var g=null;e&&l("[ \t]")}if(g!==null){var i=[];while(g!==null){i.push(g);if(a.substr(d).match(/^[ 	]/)!==null){var g=a.charAt(d);d++}else{var g=null;e&&l("[ \t]")}}}else var i=null;return e=f,e&&i===null&&l("whitespace"),h[b]={nextPos:d,result:i},i}function w(){var b="textline@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=e;e=!1;var g=d,i=d,j=[];if(a.substr(d).match(/^[^\n]/)!==null){var k=a.charAt(d);d++}else{var k=null;e&&l("[^\\n]")}while(k!==null){j.push(k);if(a.substr(d).match(/^[^\n]/)!==null){var k=a.charAt(d);d++}else{var k=null;e&&l("[^\\n]")}}if(j!==null){var m=A();if(m!==null)var n=[j,m];else{var n=null;d=i}}else{var n=null;d=i}var o=n!==null?function(a){return a.join("")}(n[0]):null;if(o!==null)var p=o;else{var p=null;d=g}return e=f,e&&p===null&&l("text line"),h[b]={nextPos:d,result:p},p}function x(){var b="rawtext@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=e;e=!1;var g=d,i=[];if(a.substr(d).match(/^[^]/)!==null){var j=a.charAt(d);d++}else{var j=null;e&&l("[^]")}while(j!==null){i.push(j);if(a.substr(d).match(/^[^]/)!==null){var j=a.charAt(d);d++}else{var j=null;e&&l("[^]")}}var k=i!==null?function(a){while(a.length>0&&a[a.length-1]=="\n")a.pop();return a.join("")}(i):null;if(k!==null)var m=k;else{var m=null;d=g}return e=f,e&&m===null&&l("heredoc contents"),h[b]={nextPos:d,result:m},m}function y(){var b="indent@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=e;e=!1;if(a.substr(d).match(/^[]/)!==null){var g=a.charAt(d);d++}else{var g=null;e&&l("[]")}return e=f,e&&g===null&&l("indent marker"),h[b]={nextPos:d,result:g},g}function z(){var b="dedent@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=e;e=!1;if(a.substr(d).match(/^[]/)!==null){var g=a.charAt(d);d++}else{var g=null;e&&l("[]")}return e=f,e&&g===null&&l("dedent marker"),h[b]={nextPos:d,result:g},g}function A(){var b="eol@"+d,c=h[b];if(c)return d=c.nextPos,c.result;var f=e;e=!1;var g=d;if(a.substr(d,1)==="\r"){var i="\r";d+=1}else{var i=null;e&&l('"\\r"')}var j=i!==null?i:"";if(j!==null){if(a.substr(d,1)==="\n"){var k="\n";d+=1}else{var k=null;e&&l('"\\n"')}if(k!==null)var m=[j,k];else{var m=null;d=g}}else{var m=null;d=g}return e=f,e&&m===null&&l("line break"),h[b]={nextPos:d,result:m},m}function B(){function b(a){a.sort();var b=null,c=[];for(var d=0;d<a.length;d++)a[d]!==b&&(c.push(a[d]),b=a[d]);switch(c.length){case 0:return"end of input";case 1:return c[0];default:return c.slice(0,c.length-1).join(", ")+" or "+c[c.length-1]}}var c=b(g),e=Math.max(d,f),h=e<a.length?k(a.charAt(e)):"end of input";return"Expected "+c+" but "+h+" found."}function C(){var b=1,c=1,d=!1;for(var e=0;e<f;e++){var g=a.charAt(e);g==="\n"?(d||b++,c=1,d=!1):g==="\r"|g==="\u2028"||g==="\u2029"?(b++,c=1,d=!0):(c++,d=!1)}return{line:b,column:c}}var c={arglist:q,argument:r,childblock:p,dedent:z,eol:A,identifier:u,indent:y,node:n,nodehead:o,nodelist:m,quotedchar:t,rawtext:x,textline:w,value:s,whitespace:v};if(b!==undefined){if(c[b]===undefined)throw new Error("Invalid rule name: "+k(b)+".")}else b="nodelist";var d=0,e=!0,f=0,g=[],h={},D=c[b]();if(D===null||d!==a.length){var E=C();throw new this.SyntaxError(B(),E.line,E.column)}return D},toSource:function(){return this._source}};return a.SyntaxError=function(a,b,c){this.name="SyntaxError",this.message=a,this.line=b,this.column=c},a.SyntaxError.prototype=Error.prototype,a}(),function(){var a,b;typeof module=="undefined"?a=this.mnml:(a=module.exports,a.parser=require("./parser").parser),a.parse=function(c){var d;if(c==null)throw new Error("parse() requires a string to parse");return d=b(c),a.parser.parse(d)},b=function(a){var b,c,d,e,f,g,h,i,j,k,l;g=a.split("\n"),c=[0],h="",d=!1;for(j=0,k=g.length;j<k;j++){f=g[j],l=f.match(/^(\s*)(.*)$/),i=l[0],e=l[1],b=l[2],e=e.length,b.length===0&&(e=c[c.length-1]);if(d){c[c.length-1]===-1&&(c[c.length-1]=e);if(e>=c[c.length-1]){e-=c[c.length-1],h+=""+Array(e+1).join(" ")+b+"\n";continue}h+="\n",c.pop(),d=!1}if(b[0]==="#")continue;if(b.length===0)continue;if(e>c[c.length-1])h+="\n",c.push(e);else while(e<c[c.length-1])h+="\n",c.pop();h+=b,!d&&b.match(/->\s*$/)&&(h+="",c.push(-1),d=!0),h+="\n"}while(c.length>1)h+="\n",c.pop();return h}}.call(this);